<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Markdown Web Browser</title>
    <link rel="stylesheet" href="/static/tailwind.css" />
  </head>
  <body class="app-body">
    <div
      class="app-shell"
      data-stream-root
      data-stream-template="/jobs/{job_id}/stream"
      data-job-id="demo"
      data-links-template="/jobs/{job_id}/links.json"
    >
      <header class="toolbar">
        <div class="toolbar__group">
          <label class="toolbar__label" for="job-url">URL</label>
          <input id="job-url" name="url" type="url" placeholder="https://example.com/article" class="toolbar__input" />
        </div>
        <div class="toolbar__group">
          <label class="toolbar__label" for="ocr-policy">OCR Policy</label>
          <select id="ocr-policy" name="ocr_policy" class="toolbar__input">
            <option value="olmocr-2-7b-1025-fp8" selected>olmOCR-2-7B-1025-FP8</option>
            <option value="olmocr-2-7b-1025">olmOCR-2-7B-1025 (FP16)</option>
          </select>
        </div>
        <div class="toolbar__group">
          <label class="toolbar__label" for="profile">Profile</label>
          <select id="profile" name="profile_id" class="toolbar__input">
            <option value="default" selected>Default</option>
            <option value="research">Research</option>
          </select>
        </div>
        <div class="toolbar__group">
          <label class="toolbar__label" for="job-id">Job ID</label>
          <input id="job-id" name="job_id" type="text" value="demo" class="toolbar__input" />
        </div>
        <button class="toolbar__button" type="button" id="run-job">Run Capture</button>
      </header>

      <section class="status-grid">
        <article class="status-card">
          <p class="status-label">State</p>
          <p class="status-value" id="job-state" data-sse-field="state">Waiting for job…</p>
        </article>
        <article class="status-card">
          <p class="status-label">Progress</p>
          <p class="status-value" id="job-progress" data-sse-field="progress">0 / 0 tiles</p>
        </article>
        <article class="status-card">
          <p class="status-label">CfT / Playwright</p>
          <p class="status-value" id="job-runtime" data-sse-field="runtime">–</p>
        </article>
        <article class="status-card">
          <p class="status-label">SSE</p>
          <p class="status-value" id="job-sse-status">Disconnected</p>
        </article>
      </section>

      <section class="tabs" data-tabs>
        <div class="tab-list" role="tablist">
          <button type="button" role="tab" class="tab" data-tab-target="rendered">Rendered Markdown</button>
          <button type="button" role="tab" class="tab" data-tab-target="raw">Raw Markdown</button>
          <button type="button" role="tab" class="tab" data-tab-target="artifacts">Artifacts</button>
          <button type="button" role="tab" class="tab" data-tab-target="links">Links</button>
          <button type="button" role="tab" class="tab" data-tab-target="manifest">Manifest</button>
          <button type="button" role="tab" class="tab" data-tab-target="embeddings">Embeddings</button>
          <button type="button" role="tab" class="tab" data-tab-target="events">Events</button>
        </div>

        <div class="tab-panels">
          <article class="tab-panel" data-tab-panel="rendered">
            <h2>Rendered Markdown</h2>
            <div class="placeholder" data-sse-field="rendered">
              Streaming preview will render here as soon as OCR tiles arrive.
            </div>
          </article>
          <article class="tab-panel" data-tab-panel="raw" hidden>
            <h2>Raw Markdown</h2>
            <pre class="placeholder" data-sse-field="raw">Waiting on OCR output…</pre>
          </article>
          <article class="tab-panel" data-tab-panel="artifacts" hidden>
            <h2>Artifacts</h2>
            <ul class="artifact-list" data-sse-field="artifacts">
              <li class="placeholder">Tile gallery + provenance metadata coming soon.</li>
            </ul>
          </article>
          <article class="tab-panel" data-tab-panel="links" hidden>
            <h2>Links</h2>
            <button type="button" class="toolbar__button toolbar__button--small" data-links-refresh>
              Refresh Links JSON
            </button>
            <div class="links-table" data-sse-field="links">
              <p class="placeholder">DOM vs OCR link delta table will populate once capture jobs run.</p>
            </div>
          </article>
          <article class="tab-panel" data-tab-panel="manifest" hidden>
            <h2>Manifest</h2>
            <pre class="placeholder manifest" data-sse-field="manifest">CfT label, Playwright version, screenshot style hash, and timing metrics will stream into this panel.</pre>
          </article>
          <article class="tab-panel" data-tab-panel="embeddings" hidden>
            <h2>Embeddings</h2>
            <p class="placeholder">sqlite-vec section search UI placeholder.</p>
          </article>
          <article class="tab-panel" data-tab-panel="events" hidden>
            <h2>Event Feed</h2>
            <ul class="event-feed" id="events-log" data-sse-log></ul>
          </article>
        </div>
      </section>
    </div>

    <script src="/static/app.js" type="module"></script>
  </body>
</html>
